"use strict";const body=document.querySelector(".js-body"),btnSearch=document.querySelector(".js-searchBtn"),form=document.querySelector(".js-form"),inputSearch=document.querySelector(".js-searchInput"),serieList=document.querySelector(".js-serieList"),favouriteSerieList=document.querySelector(".js-favouriteSerieList"),favouriteSection=document.querySelector(".js-section"),btnRemove=document.querySelector(".js-btnRemove"),btnReset=document.querySelector(".js-reset"),btnLog=document.querySelector(".js-logBtn");let seriesResultArrow=[],favouriteListArrow=[];function handlerEvent(e){e.preventDefault(),seriesResultArrow=[],body.classList.remove("full_screen"),body.classList.add("changeBackground"),hideFavSection(),connectToApi()}function connectToApi(){const e=inputSearch.value;fetch("//api.tvmaze.com/search/shows?q="+e).then((function(e){return e.json()})).then((function(e){seriesResultArrow=e,paintCard(),listenCard()}))}const paintCard=function(){let e="";for(let t=0;t<seriesResultArrow.length;t++){const o=seriesResultArrow[t].show;e+=`<li class= "serieElement js-serieElement" id ="${o.id}">`,null===o.image?e+=`<img alt="foto carátula ${o.name}" name= "foto ${o.name}" src="https://via.placeholder.com/210x295/B695C0/525252/?text=tv">`:e+=`<img alt="foto carátula ${o.name}" name= "foto ${o.name}" src="${o.image.medium}" >`,e+=`<h3 class= "serieTitle">${o.name}</h3>`,e+="</li>",serieList.innerHTML=e}};btnSearch.addEventListener("click",handlerEvent);const listenCard=function(){const e=document.querySelectorAll(".js-serieElement");for(let t of e)t.addEventListener("click",favouriteSeries)},favouriteSeries=function(e){const t=e.currentTarget;console.log(t);const o=parseInt(e.currentTarget.id);console.log(o),console.log(seriesResultArrow);const r=seriesResultArrow.find((function(e){return e.show.id===o}));if(-1===favouriteListArrow.findIndex((function(e){return e.show.id===o})))favouriteListArrow.push(r),t.classList.add("classFavourite"),paintFavourites();else{const e=favouriteListArrow.length+1;favouriteListArrow.splice(e,0),alert("This series is already in your favourite list")}setLocalStorage()},paintFavourites=function(){favouriteSection.classList.remove("hidden");let e="";for(const t of favouriteListArrow)e+='<li class= "favouriteSeries">',null===t.show.image?e+=`<img class= "favouriteSeriesImg" alt="foto carátula ${t.show.name}" name= "foto ${t.show.name}" src="https://via.placeholder.com/210x295/B695C0/525252/?text=tv">`:e+=`<img class= "favouriteSeriesImg"alt="foto carátula ${t.show.name}" name= "foto ${t.show.name}" src="${t.show.image.medium}" >`,e+=`<h3 class = "favouriteSeriesTitle">${t.show.name}</h3>`,e+=`<button  class= "js-btnRemove btnRemove" type="button" id= ${t.show.id}> X </button>`,e+="</li>";favouriteSerieList.innerHTML=e,listenRemoveBtn()};function hideFavSection(){console.log("entro en hidefav"),console.log(favouriteListArrow),0===favouriteListArrow.length&&favouriteSection.classList.add("hidden")}const listenRemoveBtn=function(){console.log("enetro en listenremove");const e=document.querySelectorAll(".js-btnRemove");for(const t of e)t.addEventListener("click",removeFavouriteSeries)},removeFavouriteSeries=function(e){console.log("entro en remove");const t=parseInt(e.currentTarget.id);console.log(t);const o=favouriteListArrow.findIndex((function(e){return e.show.id===t}));-1!==o&&(console.log("entrrrr"),favouriteListArrow.splice(o,1),console.log(favouriteListArrow)),setLocalStorage(),paintFavourites(),0===favouriteListArrow.length&&(console.log("entro aquí"),favouriteSection.classList.add("hidden"))};function setLocalStorage(){localStorage.setItem("favourites",JSON.stringify(favouriteListArrow))}function getFromLocalStorage(){const e=JSON.parse(localStorage.getItem("favourites"));if(null===e)return favouriteListArrow=[];favouriteListArrow=e,paintFavourites(),hideFavSection()}function resetLocalStorage(e){console.log("entro en reset"),favouriteListArrow=[],localStorage.clear(),e.preventDefault(),paintFavourites(),favouriteSection.classList.add("hidden"),setLocalStorage()}getFromLocalStorage(),btnReset.addEventListener("click",resetLocalStorage);